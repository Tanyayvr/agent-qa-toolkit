# Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ: Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‰Ğ°Ñ Ğ¸ Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ÑÑ‰Ğ°Ñ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñ‹

> Ğ’ÑĞµ ÑˆĞ°Ğ³Ğ¸ Ğ¿Ñ€Ğ¸Ğ²ÑĞ·Ğ°Ğ½Ñ‹ Ğº Ñ€ĞµĞ°Ğ»ÑŒĞ½Ñ‹Ğ¼ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑĞ¼, CLI-Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼ Ğ¸ Ñ„Ğ°Ğ¹Ğ»Ğ°Ğ¼ Ğ² ĞºĞ¾Ğ´Ğ¾Ğ²Ğ¾Ğ¹ Ğ±Ğ°Ğ·Ğµ.

---

## Ğ£Ñ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ¸

| Ğ Ğ¾Ğ»ÑŒ | ĞšÑ‚Ğ¾ | Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ |
|------|-----|-----------|
| **ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‰Ğ°Ñ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğ°** (Sender) | ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ AI-Ğ°Ğ³ĞµĞ½Ñ‚Ğ° | Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ñ‚ĞµÑÑ‚Ñ‹, ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ evidence pack, Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ |
| **ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ÑÑ‰Ğ°Ñ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğ°** (Receiver) | QA / Compliance / Risk / Ğ—Ğ°ĞºĞ°Ğ·Ñ‡Ğ¸Ğº | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ pack, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ñ†ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ, Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ |

---

## Ğ§Ğ°ÑÑ‚ÑŒ 1: ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‰Ğ°Ñ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğ° (Sender)

### Ğ¨Ğ°Ğ³ 1 â€” ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° Ñ‚ĞµÑÑ‚-ĞºĞµĞ¹ÑĞ¾Ğ²

Sender Ğ¾Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ²ĞµĞ´ĞµĞ½Ğ¸Ğµ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ, Ğ² JSON-Ñ„Ğ°Ğ¹Ğ»Ğµ:

```bash
# Ğ¤Ğ°Ğ¹Ğ»: cases/cases.json (Ğ¸Ğ»Ğ¸ cases/all.json Ğ´Ğ»Ñ Ğ¾Ğ±ÑŠĞµĞ´Ğ¸Ğ½Ñ‘Ğ½Ğ½Ñ‹Ñ… suites)
```

```json
[
  {
    "id": "tool_001",
    "title": "Must use get_customer before creating ticket",
    "suite": "correctness",
    "input": { "user": "Create a support ticket for customer CUST-1234" },
    "expected": {
      "tool_sequence": ["get_customer", "create_ticket"],
      "must_include": ["ticket created"],
      "evidence_required_for_actions": true
    }
  },
  {
    "id": "fmt_002",
    "title": "Return JSON: update_ticket_status payload",
    "suite": "correctness",
    "input": { "user": "Update ticket T-5678 status to resolved" },
    "expected": {
      "json_schema": {
        "type": "object",
        "required": ["ticket_id", "status"],
        "properties": {
          "ticket_id": { "type": "string" },
          "status": { "type": "string" }
        }
      }
    }
  }
]
```

**Ğ§Ñ‚Ğ¾ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Sender:**
- `id` â†’ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ID ĞºĞµĞ¹ÑĞ°
- `suite` â†’ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ° (`correctness`, `robustness`)
- `input.user` â†’ Ğ¿Ñ€Ğ¾Ğ¼Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
- `expected` â†’ 7 Ñ‚Ğ¸Ğ¿Ğ¾Ğ² assertions: `tool_required`, `tool_sequence`, `must_include`, `must_not_include`, `json_schema`, `evidence_required_for_actions`, `retrieval_required`

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `cases/all.json`, Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³ Ğ² `apps/runner/src/runner.ts` (parseCasesJson)

---

### Ğ¨Ğ°Ğ³ 2 â€” ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°

Sender Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ ÑĞ²Ğ¾ĞµĞ³Ğ¾ Ğ°Ğ³ĞµĞ½Ñ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· HTTP endpoint `/run-case`:

```bash
# ĞĞ³ĞµĞ½Ñ‚ ÑĞ»ÑƒÑˆĞ°ĞµÑ‚ Ğ½Ğ° http://localhost:8787/run-case
# ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ POST-Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ°:
```

```json
{
  "case_id": "tool_001",
  "version": "baseline",
  "input": {
    "user": "Create a support ticket for customer CUST-1234",
    "context": {}
  }
}
```

**Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ:**
- **TypeScript SDK** â†’ `createRunCaseServer()` + `wrapSimpleAgent()` Ğ¸Ğ· `packages/agent-sdk/src/index.ts`
- **Python SDK** â†’ `scripts/agent-sdk-python/agent_sdk.py`
- **Ğ›ÑĞ±Ğ¾Ğ¹ HTTP-ÑĞµÑ€Ğ²ĞµÑ€** â†’ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ‚ÑŒ JSON Ğ¿Ğ¾ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚Ñƒ Ğ¸Ğ· `docs/agent-integration-contract.md`

**ĞšĞ¾Ğ½Ñ‚Ñ€Ğ°ĞºÑ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ğ°Ğ³ĞµĞ½Ñ‚Ğ°:**

```json
{
  "case_id": "tool_001",
  "version": "baseline",
  "workflow_id": "support_v2",
  "proposed_actions": [
    {
      "action_id": "a1",
      "action_type": "lookup",
      "tool_name": "get_customer",
      "params": { "customer_id": "CUST-1234" },
      "risk_level": "low",
      "evidence_refs": [{ "kind": "tool_result", "call_id": "c1" }]
    }
  ],
  "events": [
    { "type": "tool_call", "ts": 1730000000000, "call_id": "c1", "tool": "get_customer", "args": {} },
    { "type": "tool_result", "ts": 1730000000100, "call_id": "c1", "status": "ok", "latency_ms": 100 },
    { "type": "final_output", "ts": 1730000000200, "content_type": "text", "content": "Ticket created" }
  ],
  "final_output": { "content_type": "text", "content": "Ticket created for CUST-1234" }
}
```

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** Ñ‚Ğ¸Ğ¿Ñ‹ â€” `packages/shared-types/src/index.ts`, SDK â€” `packages/agent-sdk/src/index.ts`

---

### Ğ¨Ğ°Ğ³ 3 â€” Ğ—Ğ°Ğ¿ÑƒÑĞº Runner (ÑĞ±Ğ¾Ñ€ Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ğ¾Ğ²)

```bash
# Baseline-Ğ¿Ñ€Ğ¾Ğ³Ğ¾Ğ½
npm -w runner run dev -- \
  --baseUrl http://localhost:8787 \
  --cases cases/all.json \
  --outDir apps/runner/runs \
  --runId release-2.1 \
  --redactionPreset transferable \
  --retentionDays 30

# New-Ğ¿Ñ€Ğ¾Ğ³Ğ¾Ğ½ (ÑƒĞ¶Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°)
# Runner Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ³Ğ¾Ğ½ÑĞµÑ‚ baseline + new Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ case
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Runner Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞµĞ¹ÑĞ°:**

```
1. POST /run-case â†’ Ğ°Ğ³ĞµĞ½Ñ‚
   â”œâ”€â”€ timeout: 15s (--timeoutMs)
   â”œâ”€â”€ retries: 2 Ñ exponential backoff (--retries, --backoffBaseMs)
   â””â”€â”€ concurrency: 1 (--concurrency)

2. ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚ â†’ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµÑ‚ JSON
   â”œâ”€â”€ Ğ•ÑĞ»Ğ¸ HTTP â‰¥500 â†’ RunnerFailureArtifact (class: http_error)
   â”œâ”€â”€ Ğ•ÑĞ»Ğ¸ timeout â†’ RunnerFailureArtifact (class: timeout)
   â”œâ”€â”€ Ğ•ÑĞ»Ğ¸ socket drop â†’ RunnerFailureArtifact (class: network_error)
   â”œâ”€â”€ Ğ•ÑĞ»Ğ¸ Ğ½ĞµĞ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ñ‹Ğ¹ JSON â†’ RunnerFailureArtifact (class: invalid_json)
   â””â”€â”€ Ğ•ÑĞ»Ğ¸ OK â†’ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°

3. ĞŸÑ€Ğ¸Ğ¼ĞµĞ½ÑĞµÑ‚ redaction (ĞµÑĞ»Ğ¸ preset â‰  none)
   â”œâ”€â”€ email â†’ [redacted_email]
   â”œâ”€â”€ CUST-1234 â†’ CUST-REDACTED
   â”œâ”€â”€ token_abc123 â†’ [redacted_token]
   â””â”€â”€ (extended: IP, phone, credit card, JWT)

4. ĞŸĞ¸ÑˆĞµÑ‚ Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚ Ğ½Ğ° Ğ´Ğ¸ÑĞº
   â”œâ”€â”€ apps/runner/runs/baseline/release-2.1/<caseId>.json
   â”œâ”€â”€ apps/runner/runs/new/release-2.1/<caseId>.json
   â”œâ”€â”€ apps/runner/runs/<version>/release-2.1/run.json     (Ğ¼ĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ³Ğ¾Ğ½Ğ°)
   â””â”€â”€ apps/runner/runs/<version>/release-2.1/assets/      (Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğµ Ñ‚ĞµĞ»Ğ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº)
```

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `apps/runner/src/runner.ts` (retry loop), `apps/runner/src/sanitize.ts` (redaction)

---

### Ğ¨Ğ°Ğ³ 4 â€” Ğ—Ğ°Ğ¿ÑƒÑĞº Evaluator (Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· + Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚)

```bash
npm -w evaluator run dev -- \
  --cases cases/all.json \
  --baselineDir apps/runner/runs/baseline/release-2.1 \
  --newDir apps/runner/runs/new/release-2.1 \
  --outDir apps/evaluator/reports/release-2.1 \
  --reportId release-2.1 \
  --transferClass transferable \
  --strictPortability \
  --environment docs/environment.example.json
```

**Ğ§Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Evaluator Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞµĞ¹ÑĞ°:**

```
1. Ğ§Ğ¸Ñ‚Ğ°ĞµÑ‚ baseline + new Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚Ñ‹

2. Ğ—Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ assertions (7 Ñ‚Ğ¸Ğ¿Ğ¾Ğ²)
   â”œâ”€â”€ tool_required â†’ Â«ÑÑ‚Ğ¸ tool_call Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Â»
   â”œâ”€â”€ tool_sequence â†’ Â«Ğ²Ñ‹Ğ·Ğ¾Ğ²Ñ‹ Ğ² Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµÂ»
   â”œâ”€â”€ must_include â†’ Â«Ğ² final_output ĞµÑÑ‚ÑŒ ÑÑ‚Ğ¸ Ñ„Ñ€Ğ°Ğ·Ñ‹Â»
   â”œâ”€â”€ must_not_include â†’ Â«Ğ² final_output Ğ½ĞµÑ‚ ÑÑ‚Ğ¸Ñ… Ñ„Ñ€Ğ°Ğ·Â»
   â”œâ”€â”€ json_schema â†’ AJV-Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°
   â”œâ”€â”€ evidence_required â†’ Â«actions Ğ¸Ğ¼ĞµÑÑ‚ evidence_refsÂ»
   â””â”€â”€ hallucination_signal â†’ regex-Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° output

3. Root Cause Analysis (RCA)
   â”œâ”€â”€ tool_failure â†’ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ Ğ²ĞµÑ€Ğ½ÑƒĞ» Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ
   â”œâ”€â”€ format_violation â†’ JSON Ğ½Ğµ Ğ¿Ğ¾ schema
   â”œâ”€â”€ wrong_tool_choice â†’ Ğ²Ñ‹Ğ·Ğ²Ğ°Ğ» Ğ½Ğµ Ñ‚Ğ¾Ñ‚ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚
   â”œâ”€â”€ missing_required_data â†’ Ğ½Ğµ Ñ…Ğ²Ğ°Ñ‚Ğ°ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   â”œâ”€â”€ hallucination_signal â†’ Ğ¿Ğ¾Ğ´Ğ¾Ğ·Ñ€ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ³Ğ°Ğ»Ğ»ÑÑ†Ğ¸Ğ½Ğ°Ñ†Ğ¸Ñ
   â”œâ”€â”€ missing_case â†’ Ğ°Ñ€Ñ‚ĞµÑ„Ğ°ĞºÑ‚ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½
   â””â”€â”€ unknown

4. Security Scan
   â”œâ”€â”€ secret_in_output (sk-*, api_key, token_*)
   â”œâ”€â”€ pii_in_output (email, phone patterns)
   â”œâ”€â”€ prompt_injection_marker (ignore instructions...)
   â”œâ”€â”€ high_risk_action (actions marked risk: high)
   â””â”€â”€ + custom scanners (plugin interface)

5. Gate / Risk Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ
   â”œâ”€â”€ gate_recommendation: none | require_approval | block
   â”œâ”€â”€ risk_level: low | medium | high
   â””â”€â”€ risk_tags: [regression, security_signal, ...]

6. Policy rules (Rule1-4) â†’ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ğ¾ governance

7. Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ğ°
   â”œâ”€â”€ compare-report.json    (machine truth Ğ´Ğ»Ñ CI)
   â”œâ”€â”€ report.html            (dashboard Ğ´Ğ»Ñ Ğ»ÑĞ´ĞµĞ¹)
   â”œâ”€â”€ case-<id>.html         (replay diff per case)
   â”œâ”€â”€ assets/                (evidence Ñ„Ğ°Ğ¹Ğ»Ñ‹)
   â””â”€â”€ artifacts/manifest.json (SHA-256 integrity)
```

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `apps/evaluator/src/core.ts` (pure logic), `apps/evaluator/src/evaluator.ts` (item assembly)

---

### Ğ¨Ğ°Ğ³ 5 â€” Ğ£Ğ¿Ğ°ĞºĞ¾Ğ²ĞºĞ° Evidence Pack

```bash
# Ğ£Ğ¿Ğ°ĞºĞ¾Ğ²Ğ°Ñ‚ÑŒ report directory Ğ² tar.gz
npm run pvip:pack
# â†’ apps/evaluator/reports/release-2.1.tar.gz

# Ğ’ĞµÑ€Ğ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿ĞµÑ€ĞµĞ´ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ¾Ğ¹
npm run pvip:verify
# â†’ OK: schema + manifest assets verified

# Ğ¡Ñ‚Ñ€Ğ¾Ğ³Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° (Ğ²ĞºĞ»ÑÑ‡Ğ°Ñ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑŒ manifest.sig, ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ)
export AQ_LICENSE_PUBLIC_KEY=<base64-der-spki>
npm run pvip:verify:strict
```

**Ğ§Ñ‚Ğ¾ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ pack:**

```
release-2.1/
â”œâ”€â”€ report.html                    â† offline HTML dashboard
â”œâ”€â”€ compare-report.json            â† machine truth (CI/gating)
â”œâ”€â”€ case-tool_001.html             â† replay diff per case
â”œâ”€â”€ case-fmt_002.html
â”œâ”€â”€ case-...html
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ runner_failure/            â† failure bodies
â”‚   â”œâ”€â”€ baseline/                  â† raw baseline data
â”‚   â””â”€â”€ new/                       â† raw new data
â””â”€â”€ artifacts/
    â””â”€â”€ manifest.json              â† SHA-256 per file
```

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `scripts/pvip-pack.mjs` (tar.gz), `scripts/pvip-verify.mjs` (verification)

---

### Ğ¨Ğ°Ğ³ 6 â€” ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ°

Sender Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ `release-2.1.tar.gz` Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ÑÑ‰ĞµĞ¹ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğµ:
- **Email / Slack** â†’ ĞºĞ°Ğº Ğ²Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
- **CI artifacts** â†’ GitHub Actions / GitLab CI artifact
- **S3 / GCS** â†’ shared storage
- **Jira / Confluence** â†’ Ğ¿Ñ€Ğ¸ĞºÑ€ĞµĞ¿Ğ»Ñ‘Ğ½Ğ½Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ»

> Sender Ğ½Ğ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ° SaaS-Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñƒ. Ğ¤Ğ°Ğ¹Ğ» Ğ¾ÑÑ‚Ğ°Ñ‘Ñ‚ÑÑ Ñƒ Sender Ğ´Ğ¾ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚Ğ° Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ¸.

---

## Ğ§Ğ°ÑÑ‚ÑŒ 2: ĞŸÑ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ÑÑ‰Ğ°Ñ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ğ° (Receiver)

### Ğ¨Ğ°Ğ³ 7 â€” ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸ Ñ€Ğ°ÑĞ¿Ğ°ĞºĞ¾Ğ²ĞºĞ°

```bash
# Ğ Ğ°ÑĞ¿Ğ°ĞºĞ¾Ğ²ĞºĞ°
tar -xzf release-2.1.tar.gz

# Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° â€” Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ° Ğº Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ñƒ:
cd release-2.1/
ls
# â†’ report.html  compare-report.json  case-*.html  assets/  artifacts/
```

**Receiver Ğ½Ğµ Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ° HTML** â€” Ñ„Ğ°Ğ¹Ğ» Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ² Ğ»ÑĞ±Ğ¾Ğ¼ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ.

---

### Ğ¨Ğ°Ğ³ 8 â€” Ğ’ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Ñ†ĞµĞ»Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ¸

```bash
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° toolkit (Ğ¾Ğ´Ğ½Ğ¾ĞºÑ€Ğ°Ñ‚Ğ½Ğ¾)
npm install

# Ğ’ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ pack
npm run pvip:verify -- --reportDir release-2.1/

# Ğ¡Ñ‚Ñ€Ğ¾Ğ³Ğ°Ñ Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ (SHA-256 + size match)
npm run pvip:verify -- --reportDir release-2.1/ --strict

# JSON-output Ğ²ĞµÑ€Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸ (Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸)
npm run pvip:verify -- --reportDir release-2.1/ --json
```

**Ğ§Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ `pvip:verify`:**

```
1. Schema validation
   â””â”€â”€ compare-report.json vs schemas/compare-report-v5.schema.json (AJV)

2. Manifest integrity
   â”œâ”€â”€ ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ„Ğ°Ğ¹Ğ» Ğ¸Ğ· manifest.json ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
   â”œâ”€â”€ SHA-256 hash ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ Ñ„Ğ°Ğ¹Ğ»Ğ° ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚
   â””â”€â”€ Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ñ„Ğ°Ğ¹Ğ»Ğ° ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ (--strict)

3. Portability
   â”œâ”€â”€ Ğ’ÑĞµ href'Ñ‹ â€” relative (Ğ½ĞµÑ‚ ../ Ğ½ĞµÑ‚ Ğ°Ğ±ÑĞ¾Ğ»ÑÑ‚Ğ½Ñ‹Ñ… Ğ¿ÑƒÑ‚ĞµĞ¹)
   â”œâ”€â”€ Ğ’ÑĞµ href'Ñ‹ Ğ²Ğ½ÑƒÑ‚Ñ€Ğ¸ bundle (Ğ½ĞµÑ‚ ://)
   â””â”€â”€ quality_flags.portable_paths === true

4. Embedded manifest index
   â””â”€â”€ Ğ’ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ² report.html index ÑĞ¾Ğ²Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚ Ñ manifest.json
```

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `scripts/pvip-verify.mjs`

---

### Ğ¨Ğ°Ğ³ 9 â€” ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ğ° (HTML)

```bash
open release-2.1/report.html
# (Ğ¸Ğ»Ğ¸ Ğ² Ğ»ÑĞ±Ğ¾Ğ¼ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼ Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ)
```

> Note: ĞµÑĞ»Ğ¸ LocalStorage Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ñ‘Ğ½ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ, Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹ Ğ½Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ğ¸ÑĞ¼Ğ¸.

**Ğ§Ñ‚Ğ¾ Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Receiver Ğ² report.html:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Evaluator report                                       â”‚
â”‚  contract_version: 5 Â· report_id: release-2.1           â”‚
â”‚  toolkit: 1.4.0 Â· spec: aepf-v1                         â”‚
â”‚  transfer: transferable Â· redaction: applied             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Sidebar      â”‚  Cases table                            â”‚
â”‚               â”‚                                         â”‚
â”‚  â•”â•â•â•â•â•â•â•â•—   â”‚  case_id  baseline  new  RCA  gate       â”‚
â”‚  â•‘Suites â•‘   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â•‘ all   â•‘   â”‚  tool_001  PASS    PASS  â€”    none       â”‚
â”‚  â•‘ corr  â•‘   â”‚  fmt_002   PASS    FAIL  fmt  approve    â”‚
â”‚  â•‘ robus â•‘   â”‚  tool_003  PASS    FAIL  tool block      â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•   â”‚                                         â”‚
â”‚               â”‚  Per row:                               â”‚
â”‚  â•”â•â•â•â•â•â•â•â•—   â”‚  â€¢ risk badge (low/medium/high)          â”‚
â”‚  â•‘Filtersâ•‘   â”‚  â€¢ gate badge (none/approve/block)       â”‚
â”‚  â•‘ text  â•‘   â”‚  â€¢ assertions chip                       â”‚
â”‚  â•‘ suite â•‘   â”‚  â€¢ security signals                      â”‚
â”‚  â•‘ diff  â•‘   â”‚  â€¢ trace integrity                       â”‚
â”‚  â•‘ risk  â•‘   â”‚  â€¢ evidence links                        â”‚
â”‚  â•‘ gate  â•‘   â”‚  â€¢ regression highlight (orange)         â”‚
â”‚  â•‘ statusâ•‘   â”‚  â€¢ improvement highlight (green)         â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•   â”‚                                         â”‚
â”‚               â”‚  Click case_id â†’ case-<id>.html          â”‚
â”‚  â•”â•â•â•â•â•â•â•â•—   â”‚  (baseline vs new replay diff)           â”‚
â”‚  â•‘Summaryâ•‘   â”‚                                         â”‚
â”‚  â•‘Risk   â•‘   â”‚                                         â”‚
â”‚  â•‘Coveragâ•‘   â”‚                                         â”‚
â”‚  â•‘Qualityâ•‘   â”‚                                         â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•   â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸:**
- 7 Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ² (text, suite, diff, risk, gate, status, sort)
- URL hash encoding â†’ shareable filter links
- Save/restore filter presets (localStorage)
- Click case â†’ per-case replay diff (baseline vs new side-by-side)

---

### Ğ¨Ğ°Ğ³ 10 â€” CI-Ğ³ĞµĞ¹Ñ‚Ğ¸Ğ½Ğ³ (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ)

```bash
# Ğ’ CI pipeline Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ compare-report.json:
BLOCKS=$(jq '[.items[] | select(.gate_recommendation=="block")] | length' \
  release-2.1/compare-report.json)

APPROVALS=$(jq '[.items[] | select(.gate_recommendation=="require_approval")] | length' \
  release-2.1/compare-report.json)

echo "Blocks: $BLOCKS, Approvals: $APPROVALS"

# Gate Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°:
# BLOCKS > 0 â†’ exit 1 (ÑĞ±Ğ¾Ñ€ĞºĞ° Ğ½Ğµ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚)
# APPROVALS > 0 â†’ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾, Ğ¶Ğ´Ğ°Ñ‚ÑŒ approve
# ĞĞ±Ğ° 0 â†’ exit 0 (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞº)
```

**Ğ§Ñ‚Ğ¾ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚ gate:**

| `gate_recommendation` | Ğ¢Ñ€Ğ¸Ğ³Ğ³ĞµÑ€ | Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ |
|:---------------------:|---------|----------|
| `none` | Ğ’ÑÑ‘ ĞĞš, Ğ½ĞµÑ‚ security signals | ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞº |
| `require_approval` | High severity signal / missing data / regression | Ğ ÑƒÑ‡Ğ½Ğ¾Ğ¹ review required |
| `block` | Critical signal (prompt injection, data exfil) | Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ½Ğµ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ |

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `apps/evaluator/src/core.ts` (deriveGateRecommendation)

---

### Ğ¨Ğ°Ğ³ 11 â€” Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ Receiver-Ğ°

ĞĞ° Ğ¾ÑĞ½Ğ¾Ğ²Ğµ report.html + compare-report.json Receiver Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğµ:

| Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ | Ğ§Ñ‚Ğ¾ Ğ² Ğ¾Ñ‚Ñ‡Ñ‘Ñ‚Ğµ | Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ |
|----------|-------------|---------|
| Ğ’ÑĞµ ĞºĞµĞ¹ÑÑ‹ `gate: none`, 0 regressions | âœ… Summary: 10/10 pass, 0 regressions | **Approve: Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¹** |
| 2 ĞºĞµĞ¹ÑĞ° `gate: require_approval` (medium risk) | âš ï¸ RCA: format_violation, wrong_tool_choice | **Review**: Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚ÑŒ case-*.html, Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ replay diff, Ñ€ĞµÑˆĞ¸Ñ‚ÑŒ |
| 1 ĞºĞµĞ¹Ñ `gate: block` (critical signal) | ğŸ”´ Security: prompt_injection_marker, confidence: high | **Reject: Ğ½Ğµ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ÑŒ** |
| Missing artifacts (data_coverage issues) | âš ï¸ data_coverage: missing_new_artifacts: 3 | **Reject: Ğ½ĞµĞ¿Ğ¾Ğ»Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ, Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ñ‹** |
| Portability violation | âŒ quality_flags.portable_paths: false | **Reject: pack Ğ½Ğµ Ğ¿ĞµÑ€ĞµĞ½Ğ¾ÑĞ¸Ğ¼** |

---

## Ğ¡ĞºĞ²Ğ¾Ğ·Ğ½Ğ¾Ğ¹ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ»

```mermaid
sequenceDiagram
    participant Sender as Sender<br/>(AI Team)
    participant Agent as Agent<br/>(HTTP)
    participant Runner as Runner CLI
    participant Evaluator as Evaluator CLI
    participant Pack as Evidence Pack
    participant Receiver as Receiver<br/>(QA/Compliance)

    Note over Sender: Ğ¨Ğ°Ğ³ 1: Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¸Ñ‚ cases/all.json

    Sender->>Agent: Ğ¨Ğ°Ğ³ 2: ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚ Ğ°Ğ³ĞµĞ½Ñ‚ (POST /run-case)
    
    Sender->>Runner: Ğ¨Ğ°Ğ³ 3: npm -w runner run dev
    Runner->>Agent: POST /run-case (baseline, case=tool_001)
    Agent-->>Runner: AgentResponse JSON
    Runner->>Agent: POST /run-case (new, case=tool_001)
    Agent-->>Runner: AgentResponse JSON
    Note over Runner: retry / backoff / timeout<br/>redaction / body streaming
    Runner->>Runner: Writes artifacts to disk

    Sender->>Evaluator: Ğ¨Ğ°Ğ³ 4: npm -w evaluator run dev
    Evaluator->>Evaluator: Assertions (7 types)
    Evaluator->>Evaluator: RCA (7 classifications)
    Evaluator->>Evaluator: Security scan
    Evaluator->>Evaluator: gate_recommendation
    Evaluator->>Evaluator: Generates HTML + JSON + manifest

    Sender->>Pack: Ğ¨Ğ°Ğ³ 5: npm run pvip:pack
    Note over Pack: .tar.gz Ñ SHA-256 manifest

    Sender->>Receiver: Ğ¨Ğ°Ğ³ 6: ĞŸĞµÑ€ĞµĞ´Ğ°Ñ‘Ñ‚ pack

    Receiver->>Pack: Ğ¨Ğ°Ğ³ 7: tar -xzf
    Receiver->>Receiver: Ğ¨Ğ°Ğ³ 8: npm run pvip:verify --strict
    Note over Receiver: Schema + SHA-256 + portable paths

    Receiver->>Receiver: Ğ¨Ğ°Ğ³ 9: open report.html
    Note over Receiver: Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹, replay diff, security signals

    Receiver->>Receiver: Ğ¨Ğ°Ğ³ 10: CI gating (jq .gate_recommendation)
    
    alt Ğ’ÑĞµ gate: none
        Receiver->>Sender: âœ… Approved
    else Ğ•ÑÑ‚ÑŒ require_approval
        Receiver->>Receiver: Manual review case-*.html
        Receiver->>Sender: âš ï¸ Conditional approval
    else Ğ•ÑÑ‚ÑŒ block
        Receiver->>Sender: ğŸ”´ Rejected
    end
```

---

## Docker Compose: Ğ²ÑÑ‘ Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ğµ (dev/demo)

```bash
docker compose up --build
# â†’ demo-agent:8787 â†’ runner â†’ evaluator
# â†’ apps/evaluator/reports/latest/report.html
```

ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ pipeline Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ÑÑ Ğ±ĞµĞ· ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Node.js, Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Docker.

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `docker-compose.yml`, `Dockerfile`

---

## Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

```bash
# Vendor: Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ ĞºĞ»ÑÑ‡Ğ¸ + Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ»Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ
node scripts/license-keygen.mjs
node scripts/license-sign.mjs license.json

# Customer: Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ĞµÑ‚ Ñ Ğ»Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸ĞµĞ¹
export AQ_LICENSE_PUBLIC_KEY=<base64>
export AQ_LICENSE_PATH=.license/license.json
npm -w runner run dev -- --license .license/license.json ...

# ĞÑ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
cat .license/usage.json
# â†’ { "runs_this_month": 45, "runs_total": 312 }
```

**Ğ“Ğ´Ğµ Ğ² ĞºĞ¾Ğ´Ğµ:** `packages/aq-license/src/index.ts`, ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ñ‹ â€” `scripts/license-keygen.mjs`, `scripts/license-sign.mjs`, `scripts/license-verify.mjs`
