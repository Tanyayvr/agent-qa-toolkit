[
  {
    "id": "fmt_001",
    "title": "Return JSON: create_ticket payload",
    "input": {
      "user": "Create a support ticket for customer CUST-1001: 'App crashes on login'. Return JSON only."
    },
    "expected": {
      "json_schema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "additionalProperties": false,
        "required": ["action", "customer_id", "summary", "priority"],
        "properties": {
          "action": { "type": "string", "const": "create_ticket" },
          "customer_id": { "type": "string" },
          "summary": { "type": "string" },
          "priority": { "type": "string", "enum": ["low", "medium", "high"] }
        }
      },
      "tool_required": ["create_ticket"]
    },
    "metadata": { "tags": ["format", "tool"], "severity": "high", "kind": "tool_agent" }
  },
  {
    "id": "fmt_002",
    "title": "Return JSON: update_ticket_status payload",
    "input": {
      "user": "Set ticket T-2002 status to 'resolved'. Return JSON only."
    },
    "expected": {
      "action_required": ["get_ticket", "update_ticket_status"],
      "evidence_required_for_actions": true,
      "tool_required": ["get_ticket", "update_ticket_status"],
      "tool_sequence": ["get_ticket", "update_ticket_status"],
      "json_schema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "additionalProperties": false,
        "required": ["action", "ticket_id", "status"],
        "properties": {
          "action": {
            "type": "string",
            "const": "update_ticket_status"
          },
          "ticket_id": {
            "type": "string"
          },
          "status": {
            "type": "string",
            "enum": ["open", "pending", "resolved"]
          }
        }
      }
    },
    "metadata": {
      "tags": ["format", "tool"],
      "severity": "medium",
      "kind": "tool_agent"
    }
  },
  {
    "id": "fmt_003",
    "title": "Return JSON: send_email draft payload",
    "input": {
      "user": "Draft an email to customer CUST-1003 apologizing for the delay. Return JSON only."
    },
    "expected": {
      "json_schema": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "type": "object",
        "additionalProperties": false,
        "required": ["action", "to", "subject", "body"],
        "properties": {
          "action": { "type": "string", "const": "send_email" },
          "to": { "type": "string" },
          "subject": { "type": "string" },
          "body": { "type": "string" }
        }
      },
      "tool_required": ["send_email"]
    },
    "metadata": { "tags": ["format", "tool"], "severity": "low", "kind": "tool_agent" }
  },
  {
    "id": "tool_001",
    "title": "Must use get_customer before creating ticket",
    "input": {
      "user": "Customer CUST-1004 says: 'Billing page shows error 500'. Create a ticket."
    },
    "expected": {
      "tool_required": ["get_customer", "create_ticket"],
      "tool_sequence": ["get_customer", "create_ticket"]
    },
    "metadata": { "tags": ["wrong_tool", "sequence"], "severity": "high", "kind": "tool_agent" }
  },
  {
    "id": "tool_002",
    "title": "Must search knowledge base before replying",
    "input": {
      "user": "User asks: 'How do I reset my password?' Provide the best answer."
    },
    "expected": {
      "tool_required": ["search_kb"],
      "must_include": ["reset your password"]
    },
    "metadata": { "tags": ["wrong_tool", "kb"], "severity": "medium", "kind": "rag_or_tool_agent" }
  },
  {
    "id": "tool_003",
    "title": "Must create ticket (not just answer) for outage report",
    "input": {
      "user": "We have a production outage affecting checkout. Log an incident ticket and return confirmation."
    },
    "expected": {
      "tool_required": ["create_ticket"],
      "must_include": ["incident"]
    },
    "metadata": { "tags": ["wrong_tool", "tool_required"], "severity": "high", "kind": "tool_agent" }
  },
  {
    "id": "tool_004",
    "title": "Must update ticket status when asked",
    "input": {
      "user": "Ticket T-2010 should be moved to pending while we wait for logs. Do it."
    },
    "expected": {
      "tool_required": ["update_ticket_status"],
      "must_include": ["pending"]
    },
    "metadata": { "tags": ["wrong_tool", "tool_required"], "severity": "medium", "kind": "tool_agent" }
  },
  {
    "id": "data_001",
    "title": "RAG: must retrieve policy doc before answering refund question",
    "input": {
      "user": "What is our refund policy for annual plans? Answer with a short summary."
    },
    "expected": {
      "retrieval_required": { "doc_ids": ["policy_refund_annual_v1"] },
      "must_include": ["refund"]
    },
    "metadata": { "tags": ["missing_data", "rag"], "severity": "high", "kind": "rag_agent" }
  },
  {
    "id": "data_002",
    "title": "RAG: must retrieve SLA doc before stating response times",
    "input": {
      "user": "What is the guaranteed first response time for Priority High tickets?"
    },
    "expected": {
      "retrieval_required": { "doc_ids": ["sla_support_v2"] },
      "must_include": ["Priority High"]
    },
    "metadata": { "tags": ["missing_data", "rag"], "severity": "medium", "kind": "rag_agent" }
  },
  {
    "id": "fail_001",
    "title": "Tool failure: simulate timeout on create_ticket",
    "input": {
      "user": "Create a ticket for customer CUST-9999: 'Cannot access account'. Return confirmation."
    },
    "expected": {
      "tool_required": ["create_ticket"],
      "must_include": ["ticket"]
    },
    "metadata": { "tags": ["tool_failure"], "severity": "high", "kind": "tool_agent" }
  },

  {
    "id": "fetch_http_500_001",
    "title": "Runner fetch failure: HTTP 500 with JSON body",
    "input": {
      "user": "Trigger an HTTP 500 error from the agent transport layer."
    },
    "expected": {},
    "metadata": { "tags": ["transport", "http_error"], "severity": "high", "kind": "transport_failure" }
  },
  {
    "id": "fetch_invalid_json_001",
    "title": "Runner fetch failure: 200 OK but invalid JSON body (HTML)",
    "input": {
      "user": "Trigger a 200 OK response with non-JSON body."
    },
    "expected": {},
    "metadata": { "tags": ["transport", "invalid_json"], "severity": "high", "kind": "transport_failure" }
  },
  {
    "id": "fetch_timeout_001",
    "title": "Runner fetch failure: request timeout (server stalls)",
    "input": {
      "user": "Trigger a request timeout from the agent (no response within timeout)."
    },
    "expected": {},
    "metadata": { "tags": ["transport", "timeout"], "severity": "high", "kind": "transport_failure" }
  },
  {
    "id": "fetch_network_drop_001",
    "title": "Runner fetch failure: connection drop (network_error)",
    "input": {
      "user": "Trigger a network connection drop during the request."
    },
    "expected": {},
    "metadata": { "tags": ["transport", "network_error"], "severity": "high", "kind": "transport_failure" }
  }
]
